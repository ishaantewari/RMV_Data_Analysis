from helpers import load_file
from helpers import write_file
from helpers import search_for
from helpers import findDate
import datetime 
from fuzzywuzzy import fuzz
from standarise_dates import standardize_date


logs = load_file('./final_logs.json')
mails = load_file('./subject_mails.json')
mails_to_logs = {361: 2016016, 655: 2016004, 847: 2016017, 799: 2016013, 587: 2016009, 576: 2016015, 349: 2016019, 142: 2016023, 611: 2016025, 1127: 2016026, 1015: 2016028, 131: 2016030, 1087: 2016032, 790: 2016033, 369: 2016041, 1190: 2016036, 137: 2016037, 569: 2016038, 160: 2016040, 430: 2016043, 1112: 2016048, 1078: 2016046, 57: 2016049, 120: 2016050, 287: 2016051, 563: 2016056, 147: 2016058, 228: 2016062, 552: 2016063, 632: 2016064, 879: 2016067, 597: 2016068, 91: 2016071, 309: 2016074, 548: 2016080, 54: 2016081, 801: 2016095, 336: 2016086, 504: 2016088, 825: 2016099, 52: 2016093, 534: 2016096, 50: 2016098, 1105: 2016110, 478: 2016103, 940: 2016104, 43: 2016106, 525: 2016114, 385: 2016115, 515: 2016120, 205: 2016122, 124: 2016125, 1153: 2016140, 680: 2016131, 211: 2016135, 507: 2016138, 39: 2016139, 509: 2016141, 653: 2016145, 1083: 2016157, 496: 2016149, 858: 2016161, 615: 2016155, 1197: 2017002, 1219: 2017005, 1226: 2017006, 1225: 2017031, 1248: 2017028, 1297: 2017011, 1290: 2017012, 1210: 2017015, 1307: 2017027, 1324: 2017032, 1340: 2017022, 1350: 2017025, 1368: 2017026, 1395: 2017029, 1469: 2017034, 1489: 2017046, 1523: 2017039, 1526: 2017040, 1533: 2017041, 1545: 2017044, 1552: 2017045, 1557: 2017047, 1582: 2017054, 1592: 2017052, 1599: 2017053, 1617: 2017055, 1621: 2017056, 1627: 2017057, 1635: 2017058, 1639: 2017059, 1665: 2017060, 1673: 2017065, 1662: 2017066, 1711: 2017067, 1725: 2017068, 1742: 2017073, 1763: 2017078, 1774: 2017081, 1778: 2017082, 1784: 2017083, 1792: 2017090, 1797: 2017087, 1821: 2017088, 1825: 2017089, 1820: 2017091, 1842: 2017093, 1862: 2017108, 1887: 2017098, 1884: 2017101, 1907: 2017103, 1922: 2017105, 1926: 2017107, 1975: 2017111, 1983: 2017113, 1995: 2017114, 1996: 2017117, 2020: 2017124, 2135: 2017130, 2152: 2017133, 2168: 2017135, 2214: 2017140, 2222: 2017142, 2248: 2017147, 2262: 2017151, 2270: 2017153, 2284: 2017154, 2282: 2017155, 2306: 2017159, 2320: 2017167, 2322: 2017168, 2333: 2017171, 2337: 2017172, 2340: 2017173, 2352: 2017180, 2353: 2017178, 2380: 2017179, 2402: 2017182, 2408: 2017185, 2420: 2017193, 2435: 2017189, 2452: 2017190, 2482: 2017191, 2511: 2017197, 2514: 2017198, 2564: 2017201, 2562: 2017209, 2598: 2017206, 2610: 2017208, 2637: 2017212, 2646: 2018015, 2656: 2018002, 2659: 2018003, 2669: 2018004, 2678: 2018012, 2694: 2018007, 2737: 2018014, 2757: 2018016, 2758: 2018017, 2776: 2018032, 2790: 2018028, 2773: 2018029, 2796: 2018030, 2806: 2018034, 2811: 2018035, 2816: 2018037, 2819: 2018038, 2841: 2018047, 2850: 2018044, 2849: 2018045, 2855: 2018046, 2874: 2018064, 2881: 2018052, 2887: 2018053, 2896: 2018055, 2899: 2018056, 2916: 2018061, 2934: 2018062, 2947: 2018065, 2957: 2018069, 2964: 2018071, 2969: 2018072, 2975: 2018073, 2985: 2018076, 2992: 2018077, 2999: 2018082, 2991: 2018080, 2998: 2018083, 3004: 2018090, 3034: 2018092, 3042: 2018093, 3057: 2018099, 3065: 2018102, 3083: 2018105, 3097: 2018107, 3107: 2018109, 3110: 2018111, 3121: 2018112, 3128: 2018116, 3132: 2018117, 3137: 2018118, 3140: 2018120, 3150: 2018126, 3156: 2018130, 3167: 2018133, 3173: 2018135, 3176: 2018136, 3179: 2018137, 3180: 2018139, 3185: 2018140, 3184: 2018141, 3189: 2018142, 3190: 2018143, 3191: 2018144, 3203: 2018145, 3210: 2018146, 3207: 2018147, 3213: 2018149, 3217: 2018154, 3216: 2018153, 3228: 2018157, 3235: 2018168, 3240: 2018164, 3246: 2018165, 3266: 2018170, 3265: 2018171, 3258: 2018172, 3269: 2018173, 3272: 2018181, 3280: 2018182, 3287: 2019003, 6703: 2019004, 3297: 2019006, 3305: 2019007, 4001: 2019009, 3306: 2019011, 3321: 2019013, 3327: 2019020, 3328: 2019022, 3561: 2019029, 3348: 2019033, 6839: 2019034, 3354: 2019035, 3358: 2019039, 3359: 2019041, 3367: 2019042, 3370: 2019043, 3428: 2019050, 3431: 2019051}

keys = mails_to_logs.keys()
emails = []

index = {}
for key, value in enumerate(mails):
    index[value["mailNo"]] = key

for key in keys:
    mail_index = index[key] #take mailNo and get the position in list of mails
    mail = mails[mail_index]
    print(mail["body"])
    emails.append(mail)


write_file(emails, "./log_mails.json")

print(len(keys))